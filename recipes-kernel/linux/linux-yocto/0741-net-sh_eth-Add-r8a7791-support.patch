From 826fea4397bb72cd81fab7fee954444385c7cd0c Mon Sep 17 00:00:00 2001
From: Hisashi Nakamura <hisashi.nakamura.ak@renesas.com>
Date: Wed, 17 Jul 2013 13:02:40 +0900
Subject: [PATCH 0741/1083] net: sh_eth: Add r8a7791 support

Signed-off-by: Hisashi Nakamura <hisashi.nakamura.ak@renesas.com>
---
 drivers/net/ethernet/renesas/Kconfig  | 2 +-
 drivers/net/ethernet/renesas/sh_eth.c | 7 ++++---
 drivers/net/ethernet/renesas/sh_eth.h | 4 ++--
 3 files changed, 7 insertions(+), 6 deletions(-)

diff --git a/drivers/net/ethernet/renesas/Kconfig b/drivers/net/ethernet/renesas/Kconfig
index 07bad49..b006d22 100644
--- a/drivers/net/ethernet/renesas/Kconfig
+++ b/drivers/net/ethernet/renesas/Kconfig
@@ -9,7 +9,7 @@ config SH_ETH
 		 CPU_SUBTYPE_SH7763 || CPU_SUBTYPE_SH7619 || \
 		 CPU_SUBTYPE_SH7724 || CPU_SUBTYPE_SH7734 || \
 		 CPU_SUBTYPE_SH7757 || ARCH_R8A7740 || ARCH_R8A7779 || \
-		 ARCH_R8A7790 )
+		 ARCH_R8A7790 || ARCH_R8A7791)
 	select CRC32
 	select NET_CORE
 	select MII
diff --git a/drivers/net/ethernet/renesas/sh_eth.c b/drivers/net/ethernet/renesas/sh_eth.c
index c5432f7..45054f7 100644
--- a/drivers/net/ethernet/renesas/sh_eth.c
+++ b/drivers/net/ethernet/renesas/sh_eth.c
@@ -80,7 +80,7 @@ static void sh_eth_select_mii(struct net_device *ndev)
 
 /* There is CPU dependent code */
 #if defined(CONFIG_CPU_SUBTYPE_SH7724) || defined(CONFIG_ARCH_R8A7779) \
-	|| defined(CONFIG_ARCH_R8A7790)
+	|| defined(CONFIG_ARCH_R8A7790) || defined(CONFIG_ARCH_R8A7791)
 #define SH_ETH_RESET_DEFAULT	1
 static void sh_eth_set_duplex(struct net_device *ndev)
 {
@@ -97,7 +97,8 @@ static void sh_eth_set_rate(struct net_device *ndev)
 	struct sh_eth_private *mdp = netdev_priv(ndev);
 	unsigned int bits = ECMR_RTM;
 
-#if defined(CONFIG_ARCH_R8A7779) || defined(CONFIG_ARCH_R8A7790)
+#if defined(CONFIG_ARCH_R8A7779) || defined(CONFIG_ARCH_R8A7790) \
+	|| defined(CONFIG_ARCH_R8A7791)
 	bits |= ECMR_ELB;
 #endif
 
@@ -1458,7 +1459,7 @@ static int sh_eth_phy_start(struct net_device *ndev)
 	/* reset phy - this also wakes it from PDOWN */
 	phy_write(mdp->phydev, MII_BMCR, BMCR_RESET);
 
-#if defined(CONFIG_ARCH_R8A7790)
+#if defined(CONFIG_ARCH_R8A7790) || defined(CONFIG_ARCH_R8A7791)
 	ret = phy_read(mdp->phydev, 0x1e);
 	ret &= ~0xc000;
 	ret |= 0x4000;
diff --git a/drivers/net/ethernet/renesas/sh_eth.h b/drivers/net/ethernet/renesas/sh_eth.h
index 2026fc6..74e8377 100644
--- a/drivers/net/ethernet/renesas/sh_eth.h
+++ b/drivers/net/ethernet/renesas/sh_eth.h
@@ -61,7 +61,7 @@ enum {
 	EDOCR,
 	TFUCR,
 	RFOCR,
-#if defined(CONFIG_ARCH_R8A7790)
+#if defined(CONFIG_ARCH_R8A7790) || defined(CONFIG_ARCH_R8A7791)
 	RMIIMODE,
 #endif
 	FCFTR,
@@ -301,7 +301,7 @@ static const u16 sh_eth_offset_fast_sh4[SH_ETH_MAX_REGISTER_OFFSET] = {
 	[RMCR]	= 0x0058,
 	[TFUCR]	= 0x0064,
 	[RFOCR]	= 0x0068,
-#if defined(CONFIG_ARCH_R8A7790)
+#if defined(CONFIG_ARCH_R8A7790) || defined(CONFIG_ARCH_R8A7791)
 	[RMIIMODE]	= 0x006c,
 #endif
 	[FCFTR]	= 0x0070,
-- 
1.8.3.2

