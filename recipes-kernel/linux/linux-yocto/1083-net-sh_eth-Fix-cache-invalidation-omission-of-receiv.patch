From 0f0180ebf51e5bd81c5defc89eeb82fa78e0b9db Mon Sep 17 00:00:00 2001
From: Kouei Abe <kouei.abe.cp@renesas.com>
Date: Tue, 6 Aug 2013 16:37:44 +0900
Subject: [PATCH 1083/1083] net: sh_eth: Fix cache invalidation omission of
 receive buffer

Signed-off-by: Kouei Abe <kouei.abe.cp@renesas.com>
---
 drivers/net/ethernet/renesas/sh_eth.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/net/ethernet/renesas/sh_eth.c b/drivers/net/ethernet/renesas/sh_eth.c
index 0efbb5c..2499f82 100644
--- a/drivers/net/ethernet/renesas/sh_eth.c
+++ b/drivers/net/ethernet/renesas/sh_eth.c
@@ -1142,6 +1142,8 @@ static int sh_eth_rx(struct net_device *ndev, u32 intr_status)
 			mdp->rx_skbuff[entry] = NULL;
 			if (mdp->cd->rpadir)
 				skb_reserve(skb, NET_IP_ALIGN);
+			dma_sync_single_for_cpu(&ndev->dev, rxdesc->addr,
+				mdp->rx_buf_sz,	DMA_FROM_DEVICE);
 			skb_put(skb, pkt_len);
 			skb->protocol = eth_type_trans(skb, ndev);
 			netif_rx(skb);
-- 
1.8.3.2

