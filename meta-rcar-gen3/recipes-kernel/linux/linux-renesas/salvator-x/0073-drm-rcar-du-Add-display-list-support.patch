From 2e4cdffa1a261f2ead176b9eef86ad521db77f01 Mon Sep 17 00:00:00 2001
From: Takashi Saito <takashi.saitou.ry@renesas.com>
Date: Mon, 31 Aug 2015 19:19:49 +0900
Subject: [PATCH 73/85] drm: rcar-du: Add display list support

Signed-off-by: Koji Matsuoka <koji.matsuoka.xm@renesas.com>
---
 drivers/gpu/drm/rcar-du/rcar_du_vsp.c |    7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/drivers/gpu/drm/rcar-du/rcar_du_vsp.c b/drivers/gpu/drm/rcar-du/rcar_du_vsp.c
index 8a3696c..3ca9d24 100644
--- a/drivers/gpu/drm/rcar-du/rcar_du_vsp.c
+++ b/drivers/gpu/drm/rcar-du/rcar_du_vsp.c
@@ -22,6 +22,7 @@
 #include <linux/of_platform.h>
 #include <linux/videodev2.h>
 
+#define VSP1_DL_SUPPORT
 #include <media/vsp1.h>
 
 #include "rcar_du_drv.h"
@@ -66,12 +67,18 @@ void rcar_du_vsp_enable(struct rcar_du_crtc *crtc)
 	 */
 	crtc->group->need_restart = true;
 
+#ifdef VSP1_DL_SUPPORT
+	vsp1_du_setup_dl(crtc->vsp->vsp, 2, 2);
+#endif
 	vsp1_du_setup_lif(crtc->vsp->vsp, mode->hdisplay, mode->vdisplay);
 }
 
 void rcar_du_vsp_disable(struct rcar_du_crtc *crtc)
 {
 	vsp1_du_setup_lif(crtc->vsp->vsp, 0, 0);
+#ifdef VSP1_DL_SUPPORT
+	vsp1_du_reset_dl(crtc->vsp->vsp);
+#endif
 }
 
 static const u32 formats_xlate[][2] = {
-- 
1.7.9.5

